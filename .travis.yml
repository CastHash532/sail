language: go

dist: xenial
services:
  - docker

go:
- 1.12

go_import_path: go.coder.com/sail

install: true
env:
  - GO111MODULE=on
script:
  - ci/user.sh
  - sudo su runner -c ./ci/build.sh
  - sudo -E su runner -c ./ci/test.sh

deploy:
  provider: releases
  api_key: "GITHUB OAUTH TOKEN"
  file: "bin/sail-linux-amd64"
  skip_cleanup: true
  draft: true
